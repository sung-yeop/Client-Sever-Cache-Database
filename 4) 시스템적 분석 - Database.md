# Database
## Oracle vs MySQL
* * * 
### 시작하기에 앞서
* DB 사용순위 비교
![4-0.2016년 6월 DB 사용순위](https://user-images.githubusercontent.com/43811124/49566762-1db6b780-f96f-11e8-9548-bc80594f3518.jpg)

![4-0.2017년 5월 DB 사용순위](https://user-images.githubusercontent.com/43811124/49566775-24ddc580-f96f-11e8-9343-07f897f9e4ca.jpg)

* 위 사진을 봤을때 알다시피, DB 사용순위는 Oracle, MySQL, Microsoft SQL Server 이 순서대로 가장 인기가 있는 것을 알 수 있다.
* 여기서 가장 대중적으로 사용되는 Oracle과 MySQL 이 두가지를 비교해볼 것이다.

#### **I) DB란 무엇인가?**
  * 여러 사람이 공유하고 사용할 목적으로 통합 관리되는 정보의 집합
  * 자료를 구조화해서 정리해놓은 데이터 집합체
  
#### **II) SQL이란 무엇인가?**
  * Structured Query Languaged의 준말로, 개체 관계형 데이터베이스를 지원하기해 만들어진 연산집합이다.
  * SQL은 수학적 관계 대수와 관계 논리를 기반으로 IBM 연구소에서 만들어졌다.

**1) MySQL DB**
* 모든 SQL 처리를 단일 코어에서 Nested Loop Join 방식으로만 데이터를 처리한다. (병렬 처리 X) ( 플러그인 설치시 가능함 )
* 누구나 무료로 다운받아 사용할 수 있지만, 상업적인 목적으로 MySQL을 사용하기 위해서는 라이센스를 별도로 구매해야한다.
* 대용량의 데이터 처리가 가능하며 보안에도 뛰어나다.
* 배우기 쉽고, 운영하기에도 쉽다
* Storage Engines와 같이 추가적으로 사용할 수 있는 옵션들이 많기 때문에 유연하다.
  * 1MB 이하의 설치 공간을 사용하여 작은 내장 애플리케이션을 실행하거나 수 테라바이트의 데이터를 처리하도록 확장하여 MySQL을 구성할 수 있다.
  출처 : [CIO from IDG][1]
* 통합성이 떨어진다
  * 다른 DB를 사용하고 있는 경우에는 Mysql로 변경하기가 어렵다
* 새로 추가된 기능들은 아직 안정화되지 않았다.
* 리눅스나 유닉스등 다양한 운영체제에서 설치하여 이용할 수 있다.
출처 : [CIO from IDG][2]
* 다른서버와 DB를 공유하지 않고, 슬레이브와 마스터라는 구조의 시스템으로 운용한다.

**2) Oracle DB**
* 중앙 집중 방식으로 Administration monitoring이 가능하다.
* 다른 Admin User들과 공유가 가능하다.
* 오류가 발생하면 Oracle은 이메일이나 설정되어 있는 계정으로 연락을 준다.
* 사용 패턴을 추적할 수 있다.
* MySql보다 대량의 데이터를 처리하기에 유용하다.
* 비공개 소스이며, 폐쇠적인 운영방식에 있어 보안 수준이 높다.
* 리눅스나 유닉스같은 다양한 운영체제에 설치하여 사용이 가능하다
* 다른서버들과 DB를 공유하기 떄문에 데이터 정합성이 높다.

## 카카오 뱅크의 MySQL DB
다른 시중은행에서는 **Oracle DB**를 이용해서 고객의 돈을 관리한다. 하지만 카카오 뱅크에서는 MySQL의 오픈소스 DB를 사용한다.

시중은행들이 오라클 DB를 사용하는 가장 큰 이유는 RAC(Real application clusters)라는 기능 때문이다.
* RAC는 하나의 DB를 여러 서버가 공유하는 기술이다. -> 하나의 서버가 장애가 생기더라도, 하나의 DB를 여러 서버가 공유하기 때문에 데이터 정합성이 유지 된다. -> 서버 장애가 생기더라도 고객의 돈이 사라지지 않는다는 의미

**Q : 왜 다른 시중은행에서는 MySQL DB가 아닌 Oracle DB를 이용하는가?**

A : MySQL은 위에서 언급했던 것과 같이 마스터와 슬레이브 구조의 시스템을 운용한다.

이는 마스터 서버로 시스템을 운용하면서 특정 시점마다 슬레이브 서버가 마스터 서버의 데이터를 복사한다.

만약 마스터 서버에서 오류가 생기게되면, 슬레이브 서버의 데이터를 이용하면 된다는 이론이다.

하지만 슬레이브가 특정 시점마다 마스터의 데이터를 복사하는 부분때문에 항상 마스터의 데이터가 슬레이브에 저장되어있는 것이 아니다.
이 부분은 고객의 돈이라는 데이터를 저장해야하는 은행입장에서는 매우 민감한 부분이기 때문에 Oracle DB를 사용한다.

**Q : 왜 카카오 뱅크에서는 Oracle DB가 아닌 MySQL DB를 사용한 것인가?**

A : 카카오 뱅크에서는 MySQL DB를 사용하면서 이 문제를 해결했다고 한다. 카카오뱅크에서는 Lossless Replication기능과 Master High Availability라는 기능을 조합해서 비동기 상태에서도 데이터 무손실이라는 목표를 달성했다고 발표하였다.

Q : Lossless Replication과 Master High Availability는 무엇인가?

A : 1) Lossless REplication
* 마스터에 변경이 생기면 **릴레이 로그**라는 것을 슬레이브에 남기는데, 이는 슬레이브가 마스터를 복제하기 전에도 릴레이 로그가 남는다는 의미이다.
* 릴레이로그 덕분에 슬레이브가 마스터의 데이터를 복사하기전에 셧다운 된다고 해도, 슬레이브에 남아있는 릴레이 로그를 활용해서 마스터와 똑같은 데이터를 생성할 수 있다.
 2) Master High Availability
 * Master DB가 장애로 서비스가 불가능한 상태가 되면, 자동으로 failover를 수행하여 slave DB를 master DB로 승격시켜 **다운 타임을 최소화하는 auto Failover 솔루션**이다
 * MHA Manager, Masrer, Slave 서버 총 3개가 기본 구성이며, Slave를 추가로 늘릴 수 있다.
 
위와 같은 기능을 이용해서 카카오 뱅크는 데이터의 손실을 막았다고 발표했다

`릴레이 로그를 남긴다는 개념은 사실상 마스터 DB에서 슬레이브 DB로 데이터를 계속 넘긴다는 의미가 아닌가? -> 사실상 마스터 DB를 두 개 이용하는 것과 무엇이 다른가? -> 비용적 측면에서 Oracle DB보다 효율적인 부분이 있는가?`

## 결론
**MySQL DB 선택**

선택 이유
* Oracle DB와 MySQL DB를 비교했기 때문에 MySQL DB를 선택하는 것은 아니다. 가장 차이점이 많이 나는 Oracle DB를 비교대상으로 삼았을 뿐이고,
MySQL DB가 다른 DB처럼 일반적으로 사용할 수 있다고 생각했기 때문에 MySQL DB를 선택했다.
* Oracle DB와 비교해서는 MySQL DB가 성능적으로 떨어지는 부분이 있지만, 간단한 이용방법과 카카오 뱅크의 데이터 손실을 막은 사례들을 참고하면
MySQL을 메인 줄기로 설정한 이후, 다른 기술들을 사용해서 부족한 부분을 채워나갈 수 있다고 생각했기 때문에 선택했다.
* 창의공 프로젝트에서 계획한 게임의 Volume이 크지 않기때문에 라이센스를 구매해야가면서 Oracle DB를 사용할 필요가 없다.
* 창의공 프로젝트에서 계획한 게임의 경우에는 카카오 뱅크처럼 데이터 손실을 100% 막야야 할 필요가 없으며, 일정 시점으로 데이터를 저장해주는 슬레이브 DB만으로도 복구가 가능할 것 같다. ( 서비스 이용이 생겼을 경우, 추가 보상을 주는식으로 대체하면 될 것 같다.)

  
  
  [1]: https://www.cio.com/article/2438900/data-management/five-compelling-reasons-to-use-mysql.html?page=3
  [2]: https://www.cio.com/article/2438899/data-management/eight-sound-reasons-not-to-use-mysql.html
